(this["webpackJsonpmuvies-app"]=this["webpackJsonpmuvies-app"]||[]).push([[0],{191:function(e,t,s){},192:function(e,t,s){},246:function(e,t,s){"use strict";s.r(t);var a=s(3),i=s(0),r=s.n(i),n=s(45),o=s.n(n),c=(s(191),s(72)),l=s(30),d=s(31),h=s(42),u=s(39),p=(s.p,s(192),s(36)),v=s(15),j=s(75),g=s(100),m=s(259),b=s(260),f=s(261),O=s(262),x=s(263),M=s(264),S=s(265),y=s(277),w=s(274),E=s(278),C=s(266),k=s(267),A=s(247),P=function(e){Object(h.a)(s,e);var t=Object(u.a)(s);function s(e){var a;return Object(l.a)(this,s),(a=t.call(this,e)).state={isOpen:!1},a.toggle=a.toggle.bind(Object(g.a)(a)),a}return Object(d.a)(s,[{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"componentDidMount",value:function(){var e=JSON.parse(window.sessionStorage.getItem("userAccount"));console.log("user infor from session --",e),this.setState({userInfo:e})}},{key:"render",value:function(){return Object(a.jsx)("div",{children:Object(a.jsxs)(m.a,{color:"dark",dark:!0,expand:"md",children:[Object(a.jsx)(b.a,{color:"red",tag:p.b,to:"#",children:"Muvies App"}),Object(a.jsx)(f.a,{onClick:this.toggle}),Object(a.jsxs)(O.a,{isOpen:this.state.isOpen,navbar:!0,children:[Object(a.jsxs)(x.a,{className:"mr-auto",navbar:!0,children:[Object(a.jsx)(M.a,{children:Object(a.jsx)(S.a,{tag:p.b,to:this.state.userInfo?"#":"/",children:"Home"})}),Object(a.jsx)(M.a,{children:Object(a.jsx)(S.a,{tag:p.b,to:"/movies",children:"Muvies"})}),Object(a.jsxs)(y.a,{nav:!0,inNavbar:!0,children:[Object(a.jsx)(w.a,{nav:!0,caret:!0,children:"Options"}),Object(a.jsxs)(E.a,{right:!0,children:[Object(a.jsx)(C.a,{children:"Option 1"}),Object(a.jsx)(C.a,{children:"Option 2"}),Object(a.jsx)(C.a,{divider:!0}),Object(a.jsx)(C.a,{children:"Reset"})]})]})]}),this.state.userInfo&&Object(a.jsxs)("div",{children:[Object(a.jsxs)(k.a,{color:"red",children:["Welcome ",this.state.userInfo.name]}),Object(a.jsx)(A.a,{color:"blue",floated:"right",children:Object(a.jsx)(b.a,{tag:p.b,to:"/",onClick:function(){window.sessionStorage.removeItem("userAccount")},children:"Sign Out"})})]}),!this.state.userInfo&&Object(a.jsx)(A.a,{color:"blue",floated:"right",children:Object(a.jsx)(b.a,{tag:p.b,to:"/",children:"Sign In"})})]})]})})}}]),s}(i.Component),I=s(276),D=s(273),T=s(48),G=s.n(T),R="".concat("http://localhost:8080","/").concat("movies"),N=function(){function e(){Object(l.a)(this,e)}return Object(d.a)(e,[{key:"retrieveAllMovies",value:function(e){return G.a.get("".concat(R,"/allMovies"))}},{key:"addMovie",value:function(e,t){return G.a.post("".concat(R,"/addMovie"),t)}},{key:"retrieveMovie",value:function(e,t){return G.a.get("".concat(R,"/find/").concat(t))}},{key:"deleteMovie",value:function(e,t){return G.a.delete("".concat(R,"/delete/").concat(t))}},{key:"updateMovie",value:function(e,t,s){return G.a.put("".concat(R,"/update/").concat(t),s)}},{key:"saveAndSignUpUser",value:function(e){return G.a.post("".concat(R,"/addUser"),e)}},{key:"retrieveUserById",value:function(e,t){return G.a.get("".concat(R,"/user/find/").concat(t))}},{key:"retrieveUserByEmail",value:function(e,t){return G.a.get("".concat(R,"/user/find/").concat(e,"/").concat(t))}}]),e}(),L=s(279),U=function(e){Object(h.a)(s,e);var t=Object(u.a)(s);function s(e){var a;return Object(l.a)(this,s),(a=t.call(this,e)).handleChange=function(e,t){var s=t.name,i=t.value;return a.setState(Object(j.a)({},s,i))},a.handleSubmit=function(){var e={name:a.state.name,email:a.state.email,password:a.state.password};console.log("Submitted uder for sign in ---",e),a.movieService.retrieveUserByEmail(e.email,e.password).then((function(e){if(console.log("response for search user id ---",e.data),e.data[0]){a.setState({findUserResponse:e.data[0],isAdmin:!(!e.data[0]||!0!==e.data[0].admin)});var t=e.data[0];window.sessionStorage.setItem("userAccount",JSON.stringify(t)),a.props.history.push("/movies")}else a.setState({findUserResponse:e.data,findApiError:!0,findApiErrorMessage:"Could not find your details, please SIGN UP"})})).catch((function(e){return a.setState({apiError:!0,apiErrorMessage:"Sorry , error in backend api . Please try again"}),Promise.reject(e)}))},a.state={signupContainerDivStyle:{margin:"20px"},signupFormDivStyle:{margin:"20px"},submittedUser:{name:"",email:"",password:""},name:"",email:"",password:""},a.movieService=new N,a}return Object(d.a)(s,[{key:"componentDidMount",value:function(){var e=JSON.parse(window.sessionStorage.getItem("userAccount"));console.log("user infor from session --",e),this.setState({userInfo:e})}},{key:"render",value:function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)(P,{}),Object(a.jsxs)("div",{style:{margin:"40px"},children:[this.state.findApiError&&this.state.findApiErrorMessage&&Object(a.jsx)(L.a,{color:"danger",children:this.state.findApiErrorMessage}),this.state.apiError&&this.state.apiErrorMessage&&Object(a.jsx)(L.a,{color:"danger",children:this.state.apiErrorMessage}),Object(a.jsx)(I.a,{size:"large",children:"add"===this.props.page?"Sign In":"Sign IN"}),Object(a.jsxs)(D.a,{onSubmit:this.handleSubmit,children:[Object(a.jsx)(D.a.Group,{widths:2,children:Object(a.jsx)(D.a.Input,{label:"Enter Email",placeholder:"Email",name:"email",value:this.state.email,onChange:this.handleChange,required:!0,type:"email",for:"email"})}),Object(a.jsx)(D.a.Group,{widths:2,children:Object(a.jsx)(D.a.Input,{label:"Enter Password",placeholder:"password",name:"password",value:this.state.password,onChange:this.handleChange,type:"password",required:!0})}),Object(a.jsx)(D.a.Button,{content:"Submit",primary:!0}),Object(a.jsx)(A.a,{floated:"right",content:"Explore Movies Page >",secondary:!0,primary:!0,href:"/movies"})]})]})]})}}]),s}(i.Component),B=Object(v.f)(U),z=s(173),V=s(269),F=s(270),q=s(271),J=s(272),_=s(71),W=s(268),H=function(e){Object(h.a)(s,e);var t=Object(u.a)(s);function s(e){var a;return Object(l.a)(this,s),(a=t.call(this,e)).handleOnBlurForGenre=function(e){var t=[],s=e.target&&e.target.value;console.log("genre - ",s),""!==s&&s.indexOf(",")>-1?(s.split(",").map((function(e){(e=e.trim()).trim().length>0&&t.push({name:e})})),console.log("received list and created list ====>",t),a.setState({genre:[].concat(t)})):""!==s&&a.setState({genre:[{name:s}]})},a.handleChange=function(e,t){var s=t.name,i=t.value;a.setState(Object(j.a)({},s,i))},a.handleSubmit=function(){a.setState({apiError:!1});var e={},t={name:a.state.moviename,director:a.state.director,imdb_score:(a.state.popularity/10).toFixed(1),genre:a.state.genre,popularity:a.state.popularity};a.props.isEditPage&&a.movieService.updateMovie(t.name,t.movie_id,t).then((function(t){console.log("update movie api response -",t.data),e={addEditResponseData:t.data,isSuccess:!0,isEditResponse:!0},a.setState({editedMovie:t.data,responseData:e}),a.props.responseCallback(e)})).catch((function(t){return e={isSuccess:!1,isEditResponse:!0},a.setState({responseData:e,apiError:!0,apiErrorMessage:"Sorry , error in backend api . Please try again"}),Promise.reject(t)})),a.props.isEditPage||a.movieService.addMovie(t.name,t).then((function(s){console.log("add movie api response -",s.data),e={addEditResponseData:s.data,isSuccess:!0,isEditResponse:!1,addedMovieName:t.name},a.setState({addedMovie:s.data,responseData:e}),a.props.responseCallback(e)})).catch((function(t){return e={isSuccess:!1,isEditResponse:!1,apiError:!0,apiErrorMessage:"Sorry , error in backend api . Please try again"},a.setState({apiError:!0,responseData:e}),Promise.reject(t)}))},a.state={signupContainerDivStyle:{margin:"20px"},signupFormDivStyle:{margin:"20px"},submittedMovie:{moviename:"",director:"",imdbscore:"",genre:[],popularity:""},moviename:a.props.movieToEdit&&a.props.movieToEdit.name?a.props.movieToEdit.name:"",director:a.props.movieToEdit&&a.props.movieToEdit.director?a.props.movieToEdit.director:"",popularity:a.props.movieToEdit&&a.props.movieToEdit.popularity?a.props.movieToEdit.popularity:"",genre:a.props.movieToEdit&&a.props.movieToEdit.genre?a.props.movieToEdit.genre:[],genreItem:void 0},console.log("Movie received for editing -",a.props.movieToEdit),a.movieService=new N,a}return Object(d.a)(s,[{key:"getCommaSeperatedGenreList",value:function(){return this.props.isEditPage&&!this.state.genreItem?this.props.movieToEdit.genre.map((function(e){return e.name})):this.state.genreItem}},{key:"render",value:function(){var e=this;return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{style:{margin:"40px"},children:[this.state.apiError&&this.state.apiErrorMessage&&Object(a.jsx)(L.a,{color:"danger",children:this.state.findApiErrorMessage}),Object(a.jsx)(I.a,{size:"large",children:"add"===this.props.page?"Movie Add":"Movie Update"}),Object(a.jsxs)(D.a,{onSubmit:this.handleSubmit,children:[Object(a.jsxs)(D.a.Group,{widths:2,children:[Object(a.jsx)(D.a.Input,{label:"Movie Name",placeholder:"movie name",name:"moviename",value:this.state.moviename,onChange:this.handleChange,required:!0,disabled:this.props.isEditPage}),Object(a.jsx)(D.a.Input,{label:"Director Name",placeholder:"directors name",name:"director",value:this.state.director,onChange:this.handleChange,required:!0})]}),Object(a.jsxs)(D.a.Group,{widths:2,children:[Object(a.jsx)(D.a.Input,{label:"Popularity %",placeholder:"ranges from 1 to 100",name:"popularity",value:this.state.popularity,onChange:this.handleChange,type:"number",min:1,max:100,required:!0}),Object(a.jsx)(D.a.Input,{label:"Enter Genre  - [comma sepereted for multiple Genre]",placeholder:"comma seperated genre",name:"genreItem",value:this.getCommaSeperatedGenreList(),onBlur:this.handleOnBlurForGenre,onChange:this.handleChange,required:!0,type:"text"})]}),Object(a.jsx)(D.a.Button,{content:"Submit",primary:!0})]}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(A.a,{floated:"right",content:"Back To Movies >",secondary:!0,onClick:function(){e.props.backToMoviesCallback()}})]})})}}]),s}(i.Component),K=Object(v.f)(H),Q=function(e){Object(h.a)(s,e);var t=Object(u.a)(s);function s(e){var i;return Object(l.a)(this,s),(i=t.call(this,e)).retrieveAllMoviesData=function(){i.movieService.retrieveAllMovies().then((function(e){var t;console.log("getAllMoviesData api length -",e.data.length);var s=(t=e.data,Object(z.a)(t),t);i.setState({allMovies:i.sortAsPerImdbrating(s),topGenres:i.fetchAvailableGenres(s)})}))},i.fetchAvailableGenres=function(e){var t=[];return e.map((function(e){e.genre.map((function(e){t.push(e.name)}))})),t=t.filter((function(e,t,s){return s.indexOf(e)===t})),console.log("Top Genres",t.length),t},i.sortAsPerImdbrating=function(e){return e.sort((function(e,t){return e.popularity>t.popularity?-1:1}))},i.showAddMoviePage=function(){i.setState({showAddMoviePage:!0,showUpdateMoviePage:!1,showAllMoviesPage:!1})},i.showGenreSearchButtons=function(){if(!i.state.isMobileScreen)return i.state.genreColorList.map((function(e,t){return Object(a.jsx)(A.a,{color:e,onClick:function(e){i.setState({searchValue:e.target.innerText,searchCriteria:"genre"}),console.log("selected genre -",e.target.innerText)},children:i.state.topGenres[t]})}))},i.getCommaSeperatedGenreList=function(e){return e.map((function(t,s){return s===e.length-1?t.name:t.name+","}))},i.handleAddEditCallback=function(e){console.log("call back from add/edit api with response data",e),i.setState({showAddMoviePage:!1,showUpdateMoviePage:!1,showAllMoviesPage:e.isEditResponse||e.isAddResponse||!0,isSuccessfulResponse:e.isSuccess||!1,successResponseMessage:e.isEditResponse?"Movie Edited Successfully with name :"+e.addEditResponseData.name:!e.isEditResponse&&e.addEditResponseData?"Movie Added Successfully with name :"+e.addedMovieName:"Movie Eited/Added Successfully"}),i.retrieveAllMoviesData()},i.backToMoviesPage=function(){i.setState({showAddMoviePage:!1,showUpdateMoviePage:!1,showAllMoviesPage:!0})},i.state={allMovies:[],isLoading:!0,showAddMoviePage:!1,showUpdateMoviePage:!1,showAllMoviesPage:!0,gridSize:4,selectedMovie:void 0,topGenres:[],genreColorList:["red","orange","yellow","olive","cyan","teal","blue","violet","purple","pink","brown","grey","black"],isMobileScreen:!1,searchCriteria:void 0,searchValue:void 0},i.movieService=new N,i}return Object(d.a)(s,[{key:"componentDidMount",value:function(){var e=this;this.setState({isLoading:!0});var t=JSON.parse(window.sessionStorage.getItem("userAccount"));console.log("user infor from session --",t),this.setState({userInfo:t}),window.addEventListener("resize",this.resize.bind(this)),this.resize(),this.retrieveAllMoviesData(),this.state.allMovies&&0===this.state.allMovies.length?setTimeout((function(){e.setState({isLoading:!1})}),2e3):this.setState({isLoading:!1})}},{key:"resize",value:function(){this.setState({isMobileScreen:window.innerWidth<=760})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize.bind(this))}},{key:"editMovie",value:function(e){console.log("movie to edit",e),this.setState({movieToEdit:e,showUpdateMoviePage:!0,showAddMoviePage:!1,showAllMoviesPage:!1})}},{key:"deleteMovie",value:function(e){var t=this;this.setState({apiError:!1}),console.log("movie to delete",e),this.movieService.deleteMovie(e.name,e.movie_id).then((function(s){console.log("delete movie api successful for id  -"+e.movie_id,s),t.setState({deletedMovie:e,isSuccessfulResponse:!0,successResponseMessage:s.data,isDeleteSuccess:!0},(function(){t.retrieveAllMoviesData(),window.scrollTo(0,0)}))})).catch((function(e){return t.setState({apiError:!0,apiErrorMessage:"Sorry , error in backend api . Please try again"}),Promise.reject(e)}))}},{key:"searchByGenre",value:function(e){var t=!1;if(this.state.searchValue&&this.state.searchCriteria&&"genre"===this.state.searchCriteria)for(var s=0;s<e.genre.length;s++)if(e.genre[s].name.toLowerCase().indexOf(this.state.searchValue.toLowerCase())>-1){t=!0;break}return t}},{key:"showMoviesGrid",value:function(){var e=this;return this.state.allMovies.filter((function(t){if(e.state.searchValue&&e.state.searchCriteria&&e.state.searchValue.length>=2&&"byMuvieAndDirectorName"===e.state.searchCriteria&&(t.name.toLowerCase().indexOf(e.state.searchValue.toLowerCase())>-1||t.director.toLowerCase().indexOf(e.state.searchValue.toLowerCase())>-1)||e.searchByGenre(t)||void 0===e.state.searchValue||""===e.state.searchValue)return t})).map((function(t){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{style:{whiteSpace:"nowrap"},children:t.name}),Object(a.jsx)("td",{children:t.director}),Object(a.jsx)("td",{children:e.getCommaSeperatedGenreList(t.genre)}),Object(a.jsxs)("td",{children:[t.popularity,"%"]}),e.state.userInfo&&e.state.userInfo.admin&&Object(a.jsx)("td",{children:Object(a.jsxs)(V.a,{children:[Object(a.jsx)(A.a,{size:"sm",color:"grey",onClick:function(s){return e.editMovie(t)},children:" Edit"}),Object(a.jsx)(A.a,{size:"sm",color:"red",onClick:function(s){return e.deleteMovie(t)},children:" Delete"})]})})]},t.name)}))}},{key:"searchMoviesByNameAndDirector",value:function(e){console.log("Search item -",e.target.value),this.setState({searchValue:e.target.value,searchCriteria:"byMuvieAndDirectorName"})}},{key:"render",value:function(){var e=this;return this.state.isLoading?Object(a.jsxs)("div",{style:{align:"center"},children:[Object(a.jsx)(F.a,{style:{width:"3rem",height:"3rem"}})," ",Object(a.jsx)(F.a,{style:{width:"3rem",height:"3rem"},type:"grow"})]}):Object(a.jsxs)("div",{children:[Object(a.jsx)(P,{}),this.state.showAllMoviesPage&&this.state.allMovies&&Object(a.jsxs)(q.a,{fluid:!0,children:[this.state.isSuccessfulResponse&&this.state.successResponseMessage&&Object(a.jsx)(L.a,{color:"success",children:this.state.successResponseMessage}),this.state.isFailureResponse&&this.state.failureResponseMessage&&Object(a.jsx)(L.a,{color:"danger",children:this.state.failureResponseMessage}),this.state.apiError&&this.state.apiErrorMessage&&Object(a.jsx)(L.a,{color:"danger",children:this.state.apiErrorMessage}),this.state.userInfo&&this.state.userInfo.admin&&Object(a.jsx)("div",{className:"float-right",children:Object(a.jsx)(A.a,{color:"green",onClick:function(t){return e.showAddMoviePage()},children:"Add New Movie"})}),Object(a.jsx)(I.a,{size:"large",children:"All Movies"}),this.state.allMovies&&0===this.state.allMovies.length&&Object(a.jsx)(I.a,{size:"small",children:"Data not available , please login as ADMIN to add new Movie"}),this.state.allMovies&&this.state.allMovies.length>0&&Object(a.jsx)(I.a,{size:"small",children:"Choose your favourite genre"}),this.state.topGenres&&this.state.topGenres.length>0&&Object(a.jsxs)("div",{children:[" ",this.showGenreSearchButtons()]}),Object(a.jsxs)(J.a,{className:"mt-4",children:[Object(a.jsx)("thead",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{width:"20%",children:"Name"}),Object(a.jsx)("th",{width:"20%",children:"Director"}),Object(a.jsx)("th",{width:"20%",children:"Genre"}),Object(a.jsxs)("th",{width:"20%",children:["Popularity ",Object(a.jsx)(_.a,{color:"red",name:"heart"})]}),Object(a.jsx)("th",{width:"20%",children:Object(a.jsx)(W.a,{icon:Object(a.jsx)(_.a,{name:"search",inverted:!0,circular:!0,link:!0}),placeholder:"Search...",onChange:function(t){e.searchMoviesByNameAndDirector(t)}})})]})}),Object(a.jsx)("tbody",{children:this.showMoviesGrid()})]})]}),this.state.showAddMoviePage&&Object(a.jsx)(q.a,{fluid:!0,children:Object(a.jsx)(K,{page:"add",isEditPage:!1,responseCallback:this.handleAddEditCallback,backToMoviesCallback:this.backToMoviesPage})}),this.state.showUpdateMoviePage&&Object(a.jsx)(q.a,{fluid:!0,children:Object(a.jsx)(K,{page:"edit",isEditPage:!0,movieToEdit:this.state.movieToEdit,responseCallback:this.handleAddEditCallback,backToMoviesCallback:this.backToMoviesPage})})]})}}]),s}(i.Component),X=Object(v.f)(Q),Y=function(e){Object(h.a)(s,e);var t=Object(u.a)(s);function s(e){return Object(l.a)(this,s),t.call(this,e)}return Object(d.a)(s,[{key:"render",value:function(){return Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(p.a,{children:Object(a.jsxs)(v.c,{children:[Object(a.jsx)(v.a,{path:"/",exact:!0,render:function(e){return Object(a.jsx)(B,Object(c.a)(Object(c.a)({},e),{},{isAuthed:!0}))}}),Object(a.jsx)(v.a,{path:"/signUp",exact:!0,render:function(e){return Object(a.jsx)(B,Object(c.a)(Object(c.a)({},e),{},{isAuthed:!0}))}}),Object(a.jsx)(v.a,{path:"/movies",exact:!0,render:function(e){return Object(a.jsx)(X,Object(c.a)(Object(c.a)({},e),{},{isAuthed:!0}))}})]})})})}}]),s}(i.Component),Z=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,280)).then((function(t){var s=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,n=t.getTTFB;s(e),a(e),i(e),r(e),n(e)}))};s(244),s(245);o.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(Y,{})}),document.getElementById("root")),Z()}},[[246,1,2]]]);
//# sourceMappingURL=main.033e3ecf.chunk.js.map